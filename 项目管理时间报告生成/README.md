# 项目管理时间报告生成器

Eagle插件 - 自动生成项目时间管理报告

## 📁 项目文件清单

✅ **核心文件（已完整）**
- `index.html` - 主界面文件（包含完整样式和HTML结构）
- `js/plugin.js` - 插件核心逻辑（681行，功能完整）
- `manifest.json` - 插件配置文件（已修复logo路径）
- `logo.png` - 插件图标

## 🔧 文件说明

### 1. index.html
- 用户界面：人员选择、时间范围筛选
- 内联CSS样式（渐变紫色主题）
- 引用：`js/plugin.js`

### 2. js/plugin.js
核心功能模块：
- 状态消息管理
- 日期解析（多格式支持）
- 文件夹路径缓存系统
- 人员和月份提取
- 报告生成逻辑
- CSV导出功能
- Eagle API集成

### 3. manifest.json
插件配置：
- ID: `project-report-generator`
- 版本: `1.0.0`
- 入口: `index.html`
- Logo: `logo.png` ✅ 已修复路径

## 🚀 安装步骤

1. 将整个 `项目管理时间报告生成` 文件夹复制到 Eagle 插件目录
2. 在 Eagle 中重启或刷新插件
3. 从插件菜单中打开 "生成项目报告"

## 📊 功能特性

### 数据提取
- 自动读取Eagle库中的所有素材
- 从文件夹结构提取人员信息（第一层文件夹）
- 从文件夹路径提取时间信息（格式：YYYY_MM）
- 从标签中提取项目名称和日期

### 筛选功能
- **人员筛选**：梁嘉雄、汤命沛、刘康康、王丽、唐龙或全部
- **时间范围**：可选择起止年月

### 报告内容
生成CSV文件包含以下列：
- 人员
- 项目名称
- 需求名称
- 完成时间
- 月份分类
- 标签
- 注释
- 文件路径

### 统计信息
- 人员统计（每人完成的需求数）
- 项目统计（每个项目的需求数和涉及月份数）

## 📝 预期文件夹结构

素材应按以下结构组织：
```
人员名/
  ├── 年份/
  │   ├── 季度/
  │   │   └── YYYY_MM/
  │   │       └── 素材文件
```

示例：
```
梁嘉雄/
  ├── 2025/
  │   ├── 2025_下半年/
  │   │   └── 2025_09/
  │   │       └── 需求1.png
```

## 🏷️ 标签格式

建议使用格式：`类别·项目名称·日期标记`

示例：
- `开发·客户管理系统·9.26`
- `设计·官网改版·10.15`

## 🐛 故障排查

如果遇到错误：
1. 确认Eagle版本支持插件系统
2. 检查插件文件夹权限
3. 查看Eagle开发者工具控制台（F12）
4. 确认素材文件夹结构符合预期

## 📄 文件完整性验证

所有必要文件已就绪：
- ✅ HTML界面文件
- ✅ JavaScript逻辑文件
- ✅ 插件配置文件
- ✅ 图标文件
- ✅ 文档文件

插件已准备好在Eagle中使用！

## 🆕 最新更新

### v1.3.0 (2025-12-17) - Excel报告带缩略图 ⭐
**核心功能升级**
- 📊 **Excel报告生成**：从CSV升级为带缩略图的Excel文件（.xlsx）
- 🖼️ **缩略图嵌入**：每条记录自动插入80x80像素的素材缩略图
- 🎨 **美化样式**：表头采用渐变紫色，单元格自动调整行高和边框
- 📦 **使用ExcelJS库**：引入ExcelJS 4.3.0实现图片嵌入功能
- 💼 **适合提交**：生成专业的Excel报告，方便负责人查看和管理

**技术实现**
- 自动读取Eagle素材的thumbnail或filePath作为缩略图
- 支持PNG、JPEG、GIF等多种图片格式
- 图片加载失败时显示友好提示而不影响其他数据
- 优化的进度显示（85%-100%用于Excel生成）

**注意事项**
- 需要网络连接以加载ExcelJS库（CDN）
- 大量数据时生成时间稍长（因需处理图片）
- 生成的.xlsx文件包含图片，文件大小会相应增加

### v1.2.0 (2025-10-15) - 第二阶段优化
**高级筛选功能**
- 🔍 项目名称筛选：根据关键词快速定位特定项目
- 🔎 关键词搜索：在需求名称、标签、注释中全文搜索
- 📁 文件类型筛选：支持图片、视频、文档、其他类型
- 🎯 多维度组合筛选：同时应用多个筛选条件

**错误处理增强**
- ⚠️ 智能错误识别：自动识别超时、网络、权限等错误类型
- 💡 故障排查建议：针对不同错误提供具体解决方案
- ⏱️ 超时控制机制：30秒超时保护，防止长时间卡顿
- 🛡️ 数据完整性检查：验证Eagle API响应的有效性

**用户体验提升**
- 💾 完整状态保存：保存所有筛选条件（包括高级筛选）
- 🔄 智能事件监听：文本输入框失焦时自动保存
- 📊 实时筛选反馈：显示当前筛选条件和结果数量

### v1.1.0 (2025-10-15) - 第一阶段优化
**用户体验增强**
- ✨ 快捷日期选择：一键设置本月、上月、本季度、本年度
- 📊 实时进度条：显示报告生成进度和当前步骤
- 👀 数据预览：生成前显示符合条件的记录数量
- 💾 记住选择：自动保存并恢复上次的筛选条件
- 🎯 详细反馈：完整的文件名提示和步骤说明

**功能改进**
- 优化数据处理流程，分阶段显示进度（10%-100%）
- 每10条记录更新一次进度，避免卡顿
- 生成完成后2秒自动隐藏进度条
- 筛选条件变化时自动保存到localStorage

## 版本历史

### v1.2.0 (2025-10-15)
- 🔍 新增项目名称筛选输入框
- 🔎 新增关键词全文搜索功能
- 📁 新增文件类型筛选（图片/视频/文档/其他）
- ⚠️ 增强错误处理和智能提示
- ⏱️ 添加30秒超时控制机制
- 💾 扩展localStorage保存所有筛选条件

### v1.1.0 (2025-10-15)
- ✨ 新增快捷日期按钮（本月/上月/本季度/本年度）
- 📊 新增实时进度条显示
- 👀 新增数据预览功能
- 💾 新增记住用户选择功能
- 🎯 改进用户反馈体验

### v1.0.0 (2025-10-10)
- 初始版本发布
- 支持人员筛选
- 支持时间范围筛选
- CSV报告导出
- 实时统计信息
